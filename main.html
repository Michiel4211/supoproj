<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voor Guya - Kraslot</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            touch-action: none; /* Voorkomt scrollen tijdens krassen op mobiel */
        }
        .handwritten {
            font-family: 'Dancing Script', cursive;
        }
        
        /* Kraslot Container Styles */
        #scratch-container {
            position: relative;
            width: 300px;
            height: 150px;
            margin: 0 auto;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            user-select: none;
        }

        /* De verborgen laag (Guya) */
        #secret-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        /* De kras laag (Canvas) */
        #scratch-canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 2;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/></svg>') 12 12, auto;
        }

        /* Zwevende hartjes achtergrond */
        .floating-heart {
            position: absolute;
            bottom: -10vh;
            animation: float-up 15s linear infinite;
            opacity: 0.6;
            z-index: 0;
        }
        
        @keyframes float-up {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
        }

        .fade-out {
            transition: opacity 1s ease-out;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-100 via-red-100 to-pink-200 min-h-screen flex items-center justify-center overflow-hidden relative">

    <div id="background-hearts" class="absolute inset-0 pointer-events-none"></div>

    <div class="relative z-10 bg-white/90 backdrop-blur-sm p-8 md:p-12 rounded-3xl shadow-2xl max-w-lg w-full mx-4 text-center border border-white/50">
        
        <div class="mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">
                Het <span class="text-pink-600">mooiste meisje</span> van de wereld is:
            </h1>
            <p class="text-gray-500 text-sm md:text-base">
                Krassen maar
            </p>
        </div>

        <!-- De Kraslot Zone -->
        <div id="scratch-container" class="border-4 border-pink-200">
            
            <!-- Laag 1: Het Geheim (Onderop) -->
            <div id="secret-layer" class="bg-gradient-to-r from-pink-50 to-red-50">
                <div class="text-center transform rotate-[-5deg]">
                    <span class="handwritten text-6xl text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-red-600 drop-shadow-sm font-bold block">
                        Guya!
                    </span>
                </div>
            </div>

            <!-- Laag 2: Het Canvas (Bovenop) -->
            <canvas id="scratch-canvas"></canvas>
        </div>

    </div>

    <script>
        // --- Confetti & Achtergrond ---
        function createBackgroundHearts() {
            const container = document.getElementById('background-hearts');
            const heartSVG = `<svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full text-pink-300"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>`;
            for(let i = 0; i < 15; i++) {
                const div = document.createElement('div');
                div.classList.add('floating-heart');
                div.innerHTML = heartSVG;
                const size = Math.random() * 30 + 10 + 'px';
                div.style.width = size;
                div.style.height = size;
                div.style.left = Math.random() * 100 + 'vw';
                div.style.animationDuration = (Math.random() * 10 + 10) + 's';
                div.style.animationDelay = (Math.random() * 10) + 's';
                container.appendChild(div);
            }
        }
        createBackgroundHearts();

        function launchConfetti() {
            var duration = 3 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 50 };

            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random(), y: Math.random() - 0.2 } }));
            }, 250);
            
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, shapes: ['heart'], colors: ['#FFC0CB', '#FF69B4', '#FF1493'], scalar: 2 });
        }

        // --- KRASLOT LOGICA ---
        const canvas = document.getElementById('scratch-canvas');
        const context = canvas.getContext('2d', { willReadFrequently: true });
        const container = document.getElementById('scratch-container');
        let isDrawing = false;
        let revealed = false;

        // Init Canvas Grootte
        function initCanvas() {
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
            
            // Zorg dat we weer normaal kunnen tekenen (kleur eroverheen ipv weggummen)
            context.globalCompositeOperation = 'source-over';
            
            // Vul het canvas met een 'zilveren' laag
            context.fillStyle = '#CCCCCC'; // Basis grijs
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            // Voeg wat "glans" en tekst toe
            const gradient = context.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#999');
            gradient.addColorStop(0.5, '#eee'); // Highlight
            gradient.addColorStop(1, '#999');
            context.fillStyle = gradient;
            context.fillRect(0, 0, canvas.width, canvas.height);

            // Tekst op het kraslot
            context.font = "bold 20px Montserrat";
            context.fillStyle = "#666";
            context.textAlign = "center";
            context.textBaseline = "middle";
            context.fillText("KRAS HIER!", canvas.width / 2, canvas.height / 2);
            
            // Zet de blend mode op 'verwijderen' voor het krassen
            context.globalCompositeOperation = 'destination-out';
        }

        initCanvas();

        // Muis / Touch Events
        const getMousePos = (e) => {
            const rect = canvas.getBoundingClientRect();
            // Check of het touch of muis is
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            return {
                x: clientX - rect.left,
                y: clientY - rect.top
            };
        };

        const scratch = (x, y) => {
            context.beginPath();
            context.arc(x, y, 20, 0, Math.PI * 2, false); // Grootte van de "kwast"
            context.fill();
        };

        const startScratch = (e) => {
            isDrawing = true;
            const pos = getMousePos(e);
            scratch(pos.x, pos.y);
        };

        const endScratch = () => {
            isDrawing = false;
            checkReveal();
        };

        const doScratch = (e) => {
            if (!isDrawing) return;
            e.preventDefault(); // Voorkom scrollen op mobiel
            const pos = getMousePos(e);
            scratch(pos.x, pos.y);
        };

        // Event Listeners toevoegen
        canvas.addEventListener('mousedown', startScratch);
        canvas.addEventListener('touchstart', startScratch);

        canvas.addEventListener('mousemove', doScratch);
        canvas.addEventListener('touchmove', doScratch);

        canvas.addEventListener('mouseup', endScratch);
        canvas.addEventListener('touchend', endScratch);
        canvas.addEventListener('mouseleave', endScratch);

        // Checken hoeveel er weggekrast is
        function checkReveal() {
            if (revealed) return;

            // Haal pixel data op
            const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
            const pixels = imageData.data;
            let transparentPixels = 0;

            // Tel transparante pixels (Elke 4e waarde is Alpha)
            for (let i = 3; i < pixels.length; i += 4) {
                if (pixels[i] === 0) {
                    transparentPixels++;
                }
            }

            const percentage = (transparentPixels / (pixels.length / 4)) * 100;

            // Als meer dan 40% weg is, maak de rest automatisch schoon
            if (percentage > 40) {
                revealed = true;
                canvas.classList.add('fade-out');
                launchConfetti();
                
                setTimeout(() => {
                    canvas.style.display = 'none'; // Verwijder canvas volledig na animatie
                }, 1000);
            }
        }
    </script>
</body>
</html>
